---
title: Migrate from 5.x to 6.x
sidebar_order: 100
description: "Learn about migrating from the SDK version 5 to 6"
---

The main goal of Sentry React Native SDK version 6 is bring compatibility with Sentry JavaScript version 8 and to improve our performance monitoring APIs and integrations. This version is breaking because of the JavaScript SDK dependency upgrade to version 8 and becuase we removed deprecated APIs, restructured npm package contents.

## Important changes in dependencies

The Sentry React Native SDK ships with the Sentry JavaScript SDK as a dependency. The Sentry JavaScript SDK has been updated to version 8. This version includes a number of breaking changes. Please follow the JavaScript migration guides to complete the upgrade.

The initial `@sentry/react-native@6.0.0` ships with `@sentry/core@8.31.0`. Always use the exact JavaScript SDK version, if adding it manually to your project, any other version might not be compatible with the React Native SDK.

### Performance Monitoring API changes

The main focus of the Sentry JavaScript SDK version 8 is to improve our performance monitoring APIs and that's why the Tracing APIs changes are desccribed in a standalone guide. Please follow the [Tracing API changes](/platforms/javascript/migration/v7-to-v8/v8-new-performance-api/) guide to complete the upgrade.

### General API changes

Other general JavaScript SDK version 8 changes are described in the [JavaScript SDK 7.x to 8.x migration guide](/platforms/javascript/migration/v7-to-v8/).

## Important React Native SDK `6.x` changes

This section describes the APIs changes in the Sentry React Native SDK version 6.

### React Native Tracing options moved to `Sentry.init` options

To change the follwoing options, you no longer need to create instance of React Native Tracing. Instead, you can pass them directly to `Sentry.init` options.

```javascript diff
import * as Sentry from '@sentry/react-native';

Sentry.init({
  tracesSampleRate: 1.0,
+  enableAppStartTracking: true,
+  enableNativeFramesTracking: true,
+  enableStallTracking: true,
+  enableUserInteractionTracing: true,
-  integrations: [new Sentry.ReactNativeTracing({
-    enableAppStartTracking: true,
-    enableNativeFramesTracking: true,
-    enableStallTracking: true,
-    enableUserInteractionTracing: true,
-  })],
});
```

### Navigation Instrumentations are now standalone integrations

The Navigation Instrumentations are now a standalone integrations and you need to add it to the `integrations` array in the `Sentry.init` options.

```javascript {tabTitle:Expo Router} diff
import Sentry from '@sentry/react-native';
import { useNavigationContainerRef } from 'expo-router';

- const reactNavigationIntegration = new Sentry.ReactNavigationInstrumentation();
+ const reactNavigationIntegration = new Sentry.reactNavigationIntegration();

Sentry.init({
  tracesSampleRate: 1.0,
  integrations: [
-    new Sentry.ReactNativeTracing({ routingInstrumentation }),
+    reactNavigationIntegration,
  ],
});
```

```javascript {tabTitle:React Navigation} diff
import Sentry from '@sentry/react-native';
import { NavigationContainer } from '@react-navigation/native';

- const reactNavigationIntegration = new Sentry.ReactNavigationInstrumentation();
+ const reactNavigationIntegration = new Sentry.reactNavigationIntegration();

Sentry.init({
  tracesSampleRate: 1.0,
  integrations: [
-    new Sentry.ReactNativeTracing({ routingInstrumentation }),
+    reactNavigationIntegration,
  ],
});
```

```javascript {tabTitle:React Native Navigation} diff
import Sentry from '@sentry/react-native';
import { Navigation } from 'react-native-navigation';

Sentry.init({
  tracesSampleRate: 1.0,
  integrations: [
-    new Sentry.ReactNativeTracing({
-      routingInstrumentation: new Sentry.ReactNativeNavigationInstrumentation(
-        Navigation,
-      ),
-    }),
+    new Sentry.reactNativeNavigationIntegration({
+      navigation: Navigation,
+    }),
  ],
});
```

### React Navigation version 4 is not supported

`ReactNavigationV4Instrumentation` was removed in the SDK version 6. If you are using React Navigation version 4, you need to upgrade to version 5 or never.

### RoutingInstrumentation for Custom Navigation was removed

`RoutingInstrumentation` was removed in the SDK version 6. If you are using custom navigation, use `startIdleNavigationSpan` fucntion.

```javascript {tabTitle:Direct} diff
- const routingInstrumentation = new Sentry.RoutingInstrumentation();

Sentry.init({
  tracesSampleRate: 1.0,
  integrations: [
-    new Sentry.ReactNativeTracing({
-      routingInstrumentation,
-    }),
  ],
})

const App = () => {
  <SomeNavigationLibrary
    onRouteWillChange={(newRoute) => {
-      routingInstrumentation.onRouteWillChange({
+      Sentry.startIdleNavigationSpan({
        name: newRoute.name,
        op: 'navigation'
      });
    }}
  />
};
```

```javascript {tabTitle:Integration} diff
// Before
import Sentry from '@sentry/react-native';

-class CustomInstrumentation extends Sentry.RoutingInstrumentation {
-  constructor(navigator) {
-    super();
-
-    this.navigator.registerRouteChangeListener(
-      this.routeListener.bind(this),
-    );
-  }
-
-  routeListener(newRoute) {
-    this.onRouteWillChange({
+const customNavigationIntegration = ({navigator}) => {
+  navigator.registerRouteChangeListener((newRoute) => {
+    Sentry.startIdleNavigationSpan({
      name: newRoute.name,
      op: "navigation",
-    });
-  }
-}
+    })
+  });
+
+  return {
+    name: "CustomNavigation",
+  };
+};

Sentry.init({
  tracesSampleRate: 1.0,
  integrations: [
-    new Sentry.ReactNativeTracing({
-      routingInstrumentation: new CustomInstrumentation(navigator),
-    }),
+    customNavigationIntegration({navigator}),
  ],
});
```

### `beforeNavigate` replaced by `beforeStartSpan`

The `beforeNavigate` option was removed in the SDK version 6. Use the `beforeStartSpan` option instead. The `beforeStartSpan` option is a function that is called before starting a navigation span. This function can't stop the span from being started, but it can modify the span start options before it starts.

```javascript diff
Sentry.init({
  tracesSampleRate: 1.0,
  integrations: [
-    new Sentry.ReactNativeTracing({
-      beforeNavigate: (context) => {
+    Sentry.reactNativeTracingIntegration({
+      beforeStartSpan: (options) => {
         return {
           ...options,
            op: 'navigation',
         };
       },
    }),
  ],
});
```

### `enableSpotlight` and `spotlightSidecarUrl` replaced by `spotlight`

The `enableSpotlight` and `spotlightSidecarUrl` options were removed in the SDK version 6. Use the `spotlight` option instead.

```javascript diff
import * as Sentry from '@sentry/react-native';

Sentry.init({
  tracesSampleRate: 1.0,
-  enableSpotlight: true,
-  spotlightSidecarUrl: 'http://localhost:8969/stream',
+  spotlight: true // or 'http://localhost:8969/stream',
});
```

### React Native Tracing `idleTimeout` and `maxTransactionDuration` options were removed

The `idleTimeout` and `maxTransactionDuration` options were removed in the SDK version 6. Use the `idleTimeoutMs` and `finalTimeoutMs` options from the JavaScript SDK instead.

```javascript diff
import * as Sentry from '@sentry/react-native';

Sentry.init({
  tracesSampleRate: 1.0,
  integrations: [
-    new Sentry.ReactNativeTracing({
-      idleTimeout: 1_000,
-      maxTransactionDuration: 5_000,
+    Sentry.reactNativeTracing({
+      idleTimeoutMs: 1_000,
+      finalTimeoutMs: 5_000,
    }),
  ],
});
```

### Updated behaviour of `tracePropagationTargets` in React Native

We updated the behaviour of the SDKs when no `tracePropagationTargets` option was defined. As a reminder, you can
provide a list of strings or RegExes that will be matched against URLs to tell the SDK, to which outgoing requests
tracing HTTP headers should be attached to. These tracing headers are used for distributed tracing.

Previously, on the browser and in React native, when `tracePropagationTargets` were not defined, they defaulted to the following:
`['localhost', /^\/(?!\/)/]`. This meant that all request targets to that had "localhost" in the URL, or started with a
`/` were equipped with tracing headers. This default was chosen to prevent CORS errors in your browser applications.
However, this default had a few flaws.

Going forward, when the `tracePropagationTargets` option is not set,
- tracing headers will be attached to all outgoing requests in React Native
- and to all outgoing on the same origin on the Browser (including WebViews).

For example, if you're on `https://example.com/` and you send a request to
`https://example.com/api`, the request will be traced (ie. will have trace headers attached). Requests to
`https://api.example.com/` will not, because it is on a different origin. The same goes for all applications running on
`localhost`.

When you provide a `tracePropagationTargets` option, all of the entries you defined will now be matched
against the full URL of the outgoing request. Previously, it was only matched against what you called request APIs with.
For example, if you made a request like `fetch("/api/posts")`, the provided `tracePropagationTargets` were only compared
against `"/api/posts"`.
